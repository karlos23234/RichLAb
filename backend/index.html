<!DOCTYPE html>
<html lang="hy">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BirdsGolden Web App</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-6 font-sans">

<!-- Login Screen -->
<div id="login-screen" class="max-w-md mx-auto bg-white rounded-xl shadow-lg p-6 space-y-4">
    <h2 class="text-xl font-bold text-center mb-4">’Ñ’∏÷Ç’ø÷Ñ’°’£÷Ä’•÷Ñ Telegram-’∏’æ</h2>
    <div id="login-content" class="text-center">
        <button onclick="loginWithTelegram()" class="bg-blue-500 text-white px-6 py-2 rounded-lg">
            Login with Telegram
        </button>
    </div>
    <div id="login-loading" class="hidden text-center text-gray-500">Loading...</div>
</div>

<!-- Dashboard -->
<div id="dashboard" class="max-w-md mx-auto hidden space-y-4">

  <!-- User Info -->
  <div class="flex items-center justify-between bg-white p-4 rounded-lg shadow">
    <div class="flex items-center space-x-3">
      <div class="text-4xl">üë§</div>
      <div>
        <div id="user-info" class="font-bold text-lg">User</div>
        <div class="text-sm text-gray-500">PRO</div>
      </div>
    </div>
    <button class="bg-blue-500 text-white px-3 py-1 rounded-lg text-sm">+ ‘±’æ’•’¨’°÷Å’∂’•’¨</button>
  </div>

  <!-- Referral Link -->
  <div class="bg-gray-50 p-3 rounded-lg text-gray-700 text-sm flex justify-between">
      <input type="text" id="referral-link" readonly class="flex-1 px-3 py-2 border rounded-l-lg">
      <button onclick="shareReferralLink()" class="bg-blue-500 text-white px-3 py-2 rounded-r-lg">‘ø’´’Ω’æ’•’¨</button>
  </div>

  <!-- Balance & Status -->
  <div class="flex justify-between text-sm text-gray-600">
    <span>üåê ‘º’•’¶’∏÷Ç: hy</span>
    <span>‘∏’∂’©’°÷Å’´’Ø ’¥’∂’°÷Å’∏÷Ä’§: <strong id="total-task-earnings">÷è0</strong></span>
  </div>

  <!-- Status Cards -->
  <div class="grid grid-cols-3 gap-3 text-center text-sm">
    <div class="bg-green-100 p-3 rounded-lg">üí∞<br>‘±’Ø’ø’´’æ</div>
    <div class="bg-red-100 p-3 rounded-lg">üîí<br>‘±’∂’æ’ø’°’∂’£</div>
    <div class="bg-yellow-100 p-3 rounded-lg">‚ö°<br>‘±’Ø’∂’©’°÷Ä’©’°’µ’´’∂</div>
  </div>

  <!-- Task Progress -->
  <div class="bg-gray-200 rounded-full h-4 w-full mb-2 overflow-hidden">
      <div id="task-progress-bar" class="bg-green-500 h-4 w-0 transition-all duration-500"></div>
  </div>
  <div class="flex justify-between text-sm mb-4">
      <span id="tasks-progress-text">0%</span>
      <span id="tasks-earnings-text">0÷è</span>
  </div>

  <!-- Referrals List -->
  <div id="referrals-list" class="bg-white p-4 rounded-lg shadow text-center text-gray-500">
      üë• <br>’Ä’°’∑’æ’•’ø’æ’∏÷Ç’©’µ’∏÷Ç’∂’∂’•÷Ä ’π’Ø’°’∂
  </div>

</div>

<script>
let currentUser = null;
const tg = window.Telegram?.WebApp;

function loginWithTelegram() {
    if (!tg || !tg.initDataUnsafe || !tg.initDataUnsafe.user) {
        alert("‘Ω’∂’§÷Ä’∏÷Ç’¥ ’•’∂÷Ñ ’¢’°÷Å’•’¨ ’°’µ’Ω ’ß’ª’® Telegram-’∏÷Ç’¥’ù ’´÷Ä’°’Ø’°’∂ user ’ø’æ’µ’°’¨’∂’•÷Ä’´ ’∞’°’¥’°÷Ä÷â");
        return;
    }

    currentUser = {
        id: tg.initDataUnsafe.user.id,
        first_name: tg.initDataUnsafe.user.first_name,
        last_name: tg.initDataUnsafe.user.last_name || '',
        username: tg.initDataUnsafe.user.username || '',
        language_code: tg.initDataUnsafe.user.language_code || 'hy'
    };

    localStorage.setItem('richlab_user', JSON.stringify(currentUser));
    completeLogin();
}

function checkExistingLogin() {
    const savedUser = localStorage.getItem('richlab_user');
    if (savedUser) {
        currentUser = JSON.parse(savedUser);
        completeLogin();
    }
}

function completeLogin() {
    document.getElementById('login-screen').style.display = 'none';
    document.getElementById('dashboard').classList.remove('hidden');

    updateUserInfo();
    generateReferralLink();
    loadTaskProgress();
    loadReferrals();
}

function updateUserInfo() {
    if (currentUser) {
        document.getElementById('user-info').textContent = currentUser.first_name;
    }
}

function generateReferralLink() {
    if (currentUser) {
        const referralLink = `https://t.me/BirdsGolden_bot/app?startapp=r_${currentUser.id}`;
        document.getElementById('referral-link').value = referralLink;
    }
}

function shareReferralLink() {
    const input = document.getElementById('referral-link');
    if (input && input.value) {
        navigator.clipboard.writeText(input.value)
            .then(() => alert("’Ä’≤’∏÷Ç’¥’® ’∫’°’ø’≥’•’∂’æ’•’¨ ’ß clipboard-’´’∂"))
            .catch(() => alert("’â’∞’°’ª’∏’≤’æ’•÷Å ’∫’°’ø’≥’•’∂’•’¨ ’∞’≤’∏÷Ç’¥’®"));
}

// Placeholder functions for backend data (’∫’•’ø÷Ñ ’ß ÷É’∏’≠’°÷Ä’´’∂’•’¨ ’´÷Ä’°’Ø’°’∂ ’ø’æ’µ’°’¨’∂’•÷Ä’∏’æ)
function loadTaskProgress() {
    const progress = 0; 
    document.getElementById('task-progress-bar').style.width = progress + '%';
    document.getElementById('tasks-progress-text').textContent = progress + '%';
    document.getElementById('tasks-earnings-text').textContent = '÷è0';
}

function loadReferrals() {
    const referrals = []; 
    const list = document.getElementById('referrals-list');
    if (referrals.length === 0) {
        list.innerHTML = 'üë• <br>’Ä’°’∑’æ’•’ø’æ’∏÷Ç’©’µ’∏÷Ç’∂’∂’•÷Ä ’π’Ø’°’∂';
    } else {
        list.innerHTML = referrals.map(r => `<div>${r.name}: ${r.earned}÷è</div>`).join('');
    }
}

checkExistingLogin();
</script>

</body>
</html>
